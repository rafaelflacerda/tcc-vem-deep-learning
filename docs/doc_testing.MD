# VEM Parabolic Problem - Mathematical Formulation and Test Case

## Problem Statement

We are solving a **time-dependent diffusion equation with scalar constant coefficients** using the Virtual Element Method (VEM). This serves as a fundamental test case for parabolic problems in computational mathematics.

## üìê Mathematical Formulation

### Strong Form

Find $u: \Omega \times (0,T) \rightarrow \mathbb{R}$ such that:

$$
\begin{cases}
u_t - \Delta u = f & \text{in } \Omega, \text{ for } t \in (0,T) \\
u = 0 & \text{on } \Gamma = \partial\Omega, \text{ for } t \in (0,T) \\
u(\cdot, 0) = u_0 & \text{in } \Omega
\end{cases} \quad (1)
$$

Where:

- $\Omega \subset \mathbb{R}^d$ is the (polygonal) domain of interest
- $f \in L^2(\Omega \times (0,T))$ represents the source term
- $u_0 \in L^2(\Omega)$ is the initial data
- $u$ represents the unknown variable of interest
- $u_t$ denotes the time derivative

### Weak Formulation

Find $u \in L^2(0,T; H_0^1(\Omega))$ with $u_t \in L^2(0,T; H^{-1}(\Omega))$ such that:

$$
\begin{cases}
\langle u_t(t), v \rangle + a(u(t), v) = \langle f(t), v \rangle & \forall v \in H_0^1(\Omega), \text{ for a.e. } t \in (0,T) \\
u(0) = u_0
\end{cases} \quad (2)
$$

Where:

- $\langle \cdot, \cdot \rangle$ denotes the duality product in $H_0^1(\Omega)$
- $a(u,v) = \langle \nabla u, \nabla v \rangle$ is the bilinear form

## üéØ Analytical Test Solution

For validation purposes, we use the **manufactured solution**:

$$
u(t, x_1, x_2) = e^t \sin(\pi x_1) \sin(\pi x_2) \quad (3)
$$

### Properties of the Test Solution:

- **Smooth in space and time**: Allows testing optimal convergence rates
- **Satisfies boundary conditions**: $u = 0$ on $\partial\Omega = \{0,1\} \times \{0,1\}$
- **Known derivatives**: Easy to compute source term $f$ and initial condition $u_0$
- **Exponential growth in time**: Tests temporal accuracy of integration schemes

### Derived Problem Data:

From the analytical solution, we can compute:

**Initial Condition:**
$$u_0(x_1, x_2) = \sin(\pi x_1) \sin(\pi x_2)$$

**Source Term:**
$$f(t, x_1, x_2) = e^t \sin(\pi x_1) \sin(\pi x_2) + 2\pi^2 e^t \sin(\pi x_1) \sin(\pi x_2)$$
$$= e^t (1 + 2\pi^2) \sin(\pi x_1) \sin(\pi x_2)$$

## üî¨ Convergence Analysis

### Error Measurement

The convergence of VEM is evaluated using the **discrete relative $L^2(\Omega)$ norm**:

$$
E_{h,t}^2 := \frac{m_h(u_h(\cdot, T) - u_I(\cdot, T), u_h(\cdot, T) - u_I(\cdot, T))}{m_h(u_h(\cdot, T), u_h(\cdot, T))} \quad (46)
$$

Where:

- $u_h$ is the numerical VEM solution
- $u_I$ is the interpolant of the exact solution
- $m_h(\cdot, \cdot)$ represents the discrete $L^2$ inner product
- $T$ is the final time

### Expected Convergence Rates

For VEM of order $k$:

- **$L^2$ error**: $O(h^{k+1})$
- **$H^1$ error**: $O(h^k)$
- **Energy error**: $O(h^k)$

## üó∫Ô∏è Test Geometry

### Domain

- **Unit square**: $\Omega = [0,1] \times [0,1]$
- **Structured mesh**: $3 \times 3$ grid of quadrilateral elements

### Mesh Details

```cpp
// 9 nodes arranged in 3x3 grid
Eigen::MatrixXd nodes(9, 2);
nodes << 0.0, 0.0,   0.5, 0.0,   1.0, 0.0,    // Bottom row
         0.0, 0.5,   0.5, 0.5,   1.0, 0.5,    // Middle row
         0.0, 1.0,   0.5, 1.0,   1.0, 1.0;    // Top row

// 4 quadrilateral elements
Eigen::MatrixXi elements(4, 4);
elements << 0, 1, 4, 3,    // Bottom-left element
            1, 2, 5, 4,    // Bottom-right element
            3, 4, 7, 6,    // Top-left element
            4, 5, 8, 7;    // Top-right element
```

### Geometric Properties

- **Element size**: $h = 0.5$ (characteristic element size)
- **Element type**: Regular quadrilaterals
- **Total elements**: 4
- **Total nodes**: 9
- **Domain area**: $|\Omega| = 1$

## üß™ Test Objectives

### Primary Goals:

1. **Verify VEM Assembly**: Test projection matrix computation for quadrilateral elements
2. **Validate DOF Management**: Ensure correct local-to-global mapping
3. **Check Time Integration**: Verify temporal accuracy of chosen schemes
4. **Measure Convergence**: Compare with analytical solution at final time

### Secondary Goals:

1. **Debug Projection Operators**: Verify polynomial preservation property
2. **Test Boundary Conditions**: Ensure proper Dirichlet constraint enforcement
3. **Validate Load Vector**: Check source term integration accuracy
4. **Monitor Conditioning**: Assess numerical stability of VEM operators

## üöÄ Implementation Testing Strategy

### Phase 1: Component Testing

- Test individual VEM components (projection matrices, DOF classification)
- Verify geometric computations (area, centroid, diameter)
- Check integration routines accuracy

### Phase 2: Assembly Testing

- Test element-level matrix assembly
- Verify global system assembly
- Check sparsity patterns and matrix properties

### Phase 3: Solution Testing

- Solve the parabolic problem with manufactured solution
- Compare numerical vs. analytical solution
- Measure convergence rates with mesh refinement

### Phase 4: Performance Analysis

- Monitor computational efficiency
- Check memory usage patterns
- Validate numerical stability

This test case provides a comprehensive validation framework for the VEM parabolic implementation, combining theoretical rigor with practical computational considerations.
